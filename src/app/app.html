<div class="container mx-auto p-4">
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <h1 class="card-title text-3xl mb-6">{{ title() }} - Habit Tracker</h1>
      
      <!-- Add New Habit -->
      <div class="form-control mb-6">
        <div class="input-group">
          <input 
            type="text" 
            [(ngModel)]="newHabitName"
            placeholder="Add new habit..."
            class="input input-bordered flex-1"
            (keyup.enter)="addHabit()">
          <button 
            (click)="addHabit()"
            class="btn btn-primary">
            + Add Habit
          </button>
        </div>
      </div>

      <!-- Month Navigation -->
      <div class="flex justify-between items-center mb-6">
        <button 
          (click)="previousMonth()" 
          class="btn btn-circle btn-outline">
          ←
        </button>
        <h2 class="text-xl font-semibold">{{ getMonthYear() }}</h2>
        <button 
          (click)="nextMonth()"
          class="btn btn-circle btn-outline">
          →
        </button>
      </div>

      <!-- Habit Tracker Grid -->
      <div class="overflow-x-auto">
        <table class="table table-compact w-full">
          <thead>
            <tr>
              <th class="sticky left-0 z-10 bg-base-200">Habit</th>
              <th class="text-center">Progress</th>
              <th *ngFor="let day of days" class="text-center min-w-[60px]">
                <div class="text-xs">{{ day.dayName }}</div>
                <div class="font-bold">{{ day.dayNumber }}</div>
              </th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let habit of habits" class="hover">
              <td class="sticky left-0 z-10 bg-base-100 font-medium">
                <div class="flex items-center gap-2">
                  <div [ngClass]="habit.color" class="w-3 h-3 rounded-full"></div>
                  {{ habit.name }}
                </div>
              </td>
              <td class="text-center">
                <div class="radial-progress text-primary" 
                     [style.--value]="getCompletionRate(habit.id)"
                     [style.--size]="'3rem'">
                  {{ getCompletionRate(habit.id) }}%
                </div>
              </td>
              <td *ngFor="let day of days" class="text-center p-1">
                <select 
                  class="select select-ghost select-xs w-full max-w-xs text-center text-lg"
                  [ngModel]="getEntryStatus(habit.id, day.dateString)"
                  (ngModelChange)="updateEntry(habit.id, day.dateString, $event)">
                  <option *ngFor="let option of statusOptions" [value]="option.value">
                    {{ option.icon }}
                  </option>
                </select>
              </td>
              <td class="text-center">
                <button 
                  (click)="removeHabit(habit.id)"
                  class="btn btn-error btn-sm btn-circle"
                  title="Remove habit">
                  ✕
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Summary Stats -->
      <div class="stats shadow mt-6">
        <div class="stat">
          <div class="stat-title">Total Habits</div>
          <div class="stat-value">{{ habits.length }}</div>
        </div>
        <div class="stat">
          <div class="stat-title">Days Tracked</div>
          <div class="stat-value">{{ days.length }}</div>
        </div>
        <div class="stat">
          <div class="stat-title">Overall Progress</div>
          <div class="stat-value">{{ getOverallProgress() }}%</div>
        </div>
      </div>
    </div>
  </div>
</div>

<router-outlet />