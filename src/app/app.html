<div class="container mx-auto p-4">
  <!-- Game Stats Header -->
  <div class="hero bg-gradient-to-r from-primary to-secondary text-primary-content rounded-xl mb-6">
    <div class="hero-content text-center py-8">
      <div class="max-w-md">
        <h1 class="text-4xl font-bold">🎮 {{ title() }}</h1>
        <p class="text-xl mt-2">Level {{ gameState.level }} Habit Master</p>
        
        <div class="stats stats-horizontal shadow mt-4 bg-base-100 text-base-content">
          <div class="stat place-items-center">
            <div class="stat-title">Points</div>
            <div class="stat-value text-2xl text-primary">{{ gameState.totalPoints }}</div>
            <div class="stat-desc">{{ getPointsForNextLevel() }} to next level</div>
          </div>
          <div class="stat place-items-center">
            <div class="stat-title">Daily Streak</div>
            <div class="stat-value text-2xl text-accent">{{ gameState.dailyStreak }}</div>
            <div class="stat-desc">🔥 {{ getStreakIcon(gameState.dailyStreak) }}</div>
          </div>
          <div class="stat place-items-center">
            <div class="stat-title">Achievements</div>
            <div class="stat-value text-2xl text-success">{{ gameState.achievements.length }}</div>
            <div class="stat-desc">{{ achievements.length - gameState.achievements.length }} remaining</div>
          </div>
        </div>

        <!-- Level Progress Bar -->
        <div class="w-full bg-base-200 rounded-full h-2.5 mt-4">
          <div class="bg-warning h-2.5 rounded-full transition-all duration-300" [style.width.%]="getLevelProgress()"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      
      <!-- Achievements Banner (if any unlocked) -->
      <div *ngIf="getUnlockedAchievements().length > 0" class="alert alert-success mb-6">
        <div class="flex-1">
          <h3 class="font-bold">🏆 Achievements Unlocked!</h3>
          <div class="flex gap-2 mt-2">
            <div *ngFor="let achievement of getUnlockedAchievements()" 
                 class="badge badge-lg" 
                 [title]="achievement.description">
              {{ achievement.icon }} {{ achievement.name }}
            </div>
          </div>
        </div>
      </div>
      
      <!-- Add New Habit -->
      <div class="form-control mb-6">
        <label class="label">
          <span class="label-text font-semibold">Create New Habit</span>
        </label>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-2">
          <input 
            type="text" 
            [(ngModel)]="newHabitName"
            placeholder="Habit name..."
            class="input input-bordered"
            (keyup.enter)="addHabit()">
          
          <select [(ngModel)]="newHabitType" class="select select-bordered">
            <option value="good">✨ Build (Good)</option>
            <option value="bad">🚫 Break (Bad)</option>
          </select>
          
          <select [(ngModel)]="newHabitDifficulty" class="select select-bordered">
            <option value="easy">🟢 Easy (+1)</option>
            <option value="medium">🟡 Medium (+2)</option>
            <option value="hard">🔴 Hard (+3)</option>
          </select>
          
          <button 
            (click)="addHabit()"
            class="btn btn-primary">
            + Add Habit
          </button>
        </div>
      </div>

      <!-- Month Navigation -->
      <div class="flex justify-between items-center mb-6">
        <button 
          (click)="previousMonth()" 
          class="btn btn-circle btn-outline">
          ←
        </button>
        <h2 class="text-xl font-semibold">{{ getMonthYear() }}</h2>
        <button 
          (click)="nextMonth()"
          class="btn btn-circle btn-outline">
          →
        </button>
      </div>

      <!-- Habit Tracker Grid -->
      <div class="overflow-x-auto">
        <table class="table table-compact w-full">
          <thead>
            <tr>
              <th class="sticky left-0 z-10 bg-base-200">Habit</th>
              <th class="text-center">Streak</th>
              <th class="text-center">Progress</th>
              <th *ngFor="let day of days" class="text-center min-w-[60px]">
                <div class="text-xs">{{ day.dayName }}</div>
                <div class="font-bold">{{ day.dayNumber }}</div>
              </th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let habit of habits" class="hover">
              <td class="sticky left-0 z-10 bg-base-100 font-medium">
                <div class="flex flex-col gap-1">
                  <div class="flex items-center gap-2">
                    <div [ngClass]="habit.color" class="w-3 h-3 rounded-full"></div>
                    <span>{{ getHabitTypeIcon(habit.type) }}</span>
                    <span>{{ habit.name }}</span>
                  </div>
                  <div class="text-xs opacity-70">
                    <span [ngClass]="getDifficultyColor(habit.difficulty)">
                      {{ habit.difficulty | titlecase }} 
                    </span>
                    • Best: {{ habit.bestStreak }} days
                  </div>
                </div>
              </td>
              <td class="text-center">
                <div class="flex flex-col items-center">
                  <span class="text-lg font-bold">{{ habit.streak }}</span>
                  <span class="text-xs">{{ getStreakIcon(habit.streak) }}</span>
                </div>
              </td>
              <td class="text-center">
                <div class="radial-progress text-primary" 
                     [style.--value]="getCompletionRate(habit.id)"
                     [style.--size]="'2.5rem'">
                  <span class="text-xs">{{ getCompletionRate(habit.id) }}%</span>
                </div>
              </td>
              <td *ngFor="let day of days" class="text-center p-1">
                <select 
                  class="select select-ghost select-xs w-full max-w-xs text-center text-lg"
                  [ngModel]="getEntryStatus(habit.id, day.dateString)"
                  (ngModelChange)="updateEntry(habit.id, day.dateString, $event)">
                  <option *ngFor="let option of statusOptions" [value]="option.value">
                    {{ option.icon }}
                  </option>
                </select>
              </td>
              <td class="text-center">
                <button 
                  (click)="removeHabit(habit.id)"
                  class="btn btn-error btn-sm btn-circle"
                  title="Remove habit">
                  ✕
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Game Progress Stats -->
      <div class="stats stats-vertical lg:stats-horizontal shadow mt-6">
        <div class="stat">
          <div class="stat-figure text-primary">
            <div class="text-3xl">🎯</div>
          </div>
          <div class="stat-title">Active Habits</div>
          <div class="stat-value text-primary">{{ habits.length }}</div>
          <div class="stat-desc">{{ getGoodHabitsCount() }} building, {{ getBadHabitsCount() }} breaking</div>
        </div>
        
        <div class="stat">
          <div class="stat-figure text-secondary">
            <div class="text-3xl">🏆</div>
          </div>
          <div class="stat-title">Best Streak</div>
          <div class="stat-value text-secondary">{{ gameState.longestStreak }}</div>
          <div class="stat-desc">days in a row</div>
        </div>
        
        <div class="stat">
          <div class="stat-figure text-accent">
            <div class="text-3xl">✨</div>
          </div>
          <div class="stat-title">Overall Progress</div>
          <div class="stat-value text-accent">{{ getOverallProgress() }}%</div>
          <div class="stat-desc">across all habits</div>
        </div>
        
        <div class="stat">
          <div class="stat-figure text-success">
            <div class="text-3xl">⚡</div>
          </div>
          <div class="stat-title">Total Score</div>
          <div class="stat-value text-success">{{ gameState.totalPoints }}</div>
          <div class="stat-desc">points earned</div>
        </div>
      </div>
    </div>
  </div>
</div>

<router-outlet />